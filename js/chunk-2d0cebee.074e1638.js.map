{"version":3,"sources":["webpack:///./src/posts/cocos-creator-marching-squares.js"],"names":["content","module","exports"],"mappings":"iGAAA,IAAMA,EAAU,qgPAuGhBC,EAAOC,QAAU,CAChBF","file":"js/chunk-2d0cebee.074e1638.js","sourcesContent":["const content = `\n## Following Video 2\n\nJust like [last time], I'm following the [tutorial video] that goes through the marching square algorithm for unity and C#. \nI'm then taking that information and code and converting it into typescript and into the Cocos creator framework for fun.\nI'm not going into detail for each part like the video does, but instead just blogging about anything that pops up as interesting\nas I go through this process. So, be forewarned that this is just a collection of gotchas and aha moments from an idiot learning a\nfew new tricks.\n\n## Typescript class constructors\n\nAbout 5 minutes into the video, after the excellent breakdown of control nodes and how we'll be representing mesh triangle configurations\nwith numbers 0 - 14, Sebastion begins instructing us to create a inner class called Node. Now, Cocos creator already _has_ a class called\nNode. So, my code won't be having the same, for now I'll just call it _MNode_ because it's a node inside of the mesh generator class.\nSecondly, I actually don't know how to declare a constructor in typescript. So, [I had to look it up]. It's bizarre, but this is the third\nway of constructor-ing that I think I've seen before.\n\nIn C++ I know of just using the class name for the constructor method. In scala you can use _this()_ and if you're working with companion objects\nand case classes you can use the apply method. I've probably seen other methods before as well over the course of using the various languages I've\nworked in over the years, but I think this is the first time I've ever actually seen the word constructor used for the constructor. How bizarre:\n\n\tclass MNode {\n\t    public position: Vec3;\n\t    public vertexIndex = -1;\n\n\t    constructor(_pos: Vec3) {\n\t        this.position = _pos;\n\t    }    \n\t}\n\nThe other unfortunate thing is that, while C# allows Sebastian to make his Node class an inner class, I can't do the same in typescript [without some wonkery], so I elected not to do that and instead cluttered up my global namespace with these classes. Such is life.\n\n## Lengthy vector math in typescript land\n\nFollowing Sebastian's conventions, I've named the incoming arguments with an underscore and assigned them as expected. The next class we make takes\na dramatic leap from C# land into Typescript though. Sebastion's code is easy to read and understand because of the way C# methods can be defined \nand made to look really really clean. AKA, the vector math is nice looking in this C# code:\n\n\tpublic ControlNode(Vector3 _pos, bool _active, float squareSize) : base(_pos) {\n\t\tactive = _active;\n\t\tabove = new Node(position + Vector3.forward * squareSize/2f);\n\t\tright = new Node(position + Vector3.right * squareSize/2f);\n\t}\n\nHowever, Cocos creator's vectors are less... nice:\n\n\tclass ControlNode extends MNode {\n\t    public active: boolean;\n\t    public above: MNode;\n\t    public right: MNode;\n\n\t    constructor(_pos: Vec3, _active: boolean, _size: number) {\n\t        super(_pos);\n\t        this.active = _active;\n\t        let outPosition1: Vec3;\n\t        let abovePosition: Vec3;\n\t        Vec3.multiplyScalar(outPosition1, Vec3.FORWARD, _size/2.0);\n\t        Vec3.add(abovePosition, this.position, outPosition1);\n\t        this.above = new MNode(abovePosition);\n\n\t        let outPosition2: Vec3;\n\t        let rightPosition: Vec3;\n\t        Vec3.multiplyScalar(outPosition2, Vec3.RIGHT, _size/2.0);\n\t        Vec3.add(rightPosition, this.position, outPosition2)\n\t        this.right = new MNode(rightPosition);\n\t    }\n\t}\n\nThe main reason for this lengthy code is because the Coco's vector library helpers take in a vector that it will then populate with the results of the\noperation. As oppose to returning one. I'm sure there's a reason for this, I'd assume performance, but it is a bit of a pain. Especially since I'm not\neven sure if I should be initializing the vector I pass in or not!\n\n## The joy of not having Gizmos...\n\nIf you recall, [last time] I noted that Cocos doesn't have the Gizmos debugging tool that Unity does, but I worked around it by just spawning prefab cubes\nin the places we needed to show the boxes. That worked well enough if you consider that instead of coloring the boxes white and black based on their active\nstate I just spawned a block or didn't. However, in the code that Sebastian starts whipping up around 20 minutes into the tutorial, he starts setting the \ncolor of his debugging boxes.\n\nI tried. I really did, looking at the mesh renderer and the graphics components in cocos, heck I even thought I had things going in the right direction when I was looking at [the fill color page]... before I realized that was for the 2d library components and not the 3d one. But eventually, I landed on\n[the 3d primative page] and realized that I couldn't get away with my tricks anymore and I actually needed to make my own cube if I wanted to color things\nin as expected. Which seems kinda silly when you consider that the whole point of all these control nodes and things are to make a mesh. But I wanted to \nbe able to debug in a similar way so I could follow along the tutorial nicely, so... I kept reading, and kept fiddling with intellisense, and [reading about meshes] and even briefly contemplating ditching cocos and just using unreal or something. But, after looking through some blog posts and being reminded about the wonderful world of preprocessor directives I decided to go back to cocos and try to keep things simple for now and that's when I found \n[the aviator project code]. Which seemed promising. But, no dice considering that's using the 2.x code and seems to contain the code that the other page was using too.\n\nAfter an hour or so of looking around, I somehow managed to land on the [Javascript API reference page] and, despite fiddling around in my editor, the intellisense was telling me none of this stuff actually existed in the code I was using. Past midnight, and feeling slightly defeated, I put down the \nproject for a little while and wondered what I could do to get this working again or if I'd need to swap away from this pipedream of trying to use a \"simple\" game engine first before jumping into one of the more well known ones. \n\nI slept on it, talked to a coworker the next day about my little side project, and then decided that if Unity was easier to use than cocos, better documented, and other people\n[had noted that it really didn't work well for them either], then well, maybe I was barking up the wrong tree. With that, I decided to uninstall Cocos, finish this blog post up, \nand decide to start fresh from part 1 again next time. I'll see you then.\n\n[last time]:following-a-unity-tutorial-in-cocos-creator\n[tutorial video]:https://www.youtube.com/watch?v=yOgIncKp0BE\n[I had to look it up]:https://www.typescriptlang.org/docs/handbook/2/classes.html\n[without some wonkery]:https://stackoverflow.com/questions/32494174/can-you-create-nested-classes-in-typescript\n[the 3d primative page]:https://docs.cocos.com/creator/manual/en/3d/primitive.html\n[the fill color page]:https://docs.cocos.com/creator/manual/en/render/graphics/fillColor.html\n[reading about meshes]:https://docs.cocos.com/creator/manual/en/3d/mesh.html\n[the aviator project code]:https://github.com/cocos-creator/demo-the-aviator/blob/master/assets/src/primitive/primitive.js\n[Javascript API reference page]:https://docs.cocos2d-x.org/api-ref/js/v3x/\n[had noted that it really didn't work well for them either]:https://www.quora.com/Cocos-Creator-is-out-Does-it-mean-that-Cocos2d-x-is-also-the-past-Is-Cocos2d-x-still-worth-learning\n`;\nmodule.exports = {\n\tcontent\n};"],"sourceRoot":""}